<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GREEN-API Test Client</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .container { display: flex; gap: 20px; }
        .left { flex: 1; }
        .right { flex: 1; }
        input, button { width: 100%; margin: 10px 0; padding: 10px; box-sizing: border-box; }
        textarea { width: 100%; height: 500px; margin: 10px 0; padding: 10px; box-sizing: border-box; resize: vertical; border: 1px solid #ddd; background: #f5f5f5; }
        button { background: #25D366; color: white; border: none; cursor: pointer; font-size: 16px; }
        button:hover { background: #128C7E; }
        label { display: block; margin-top: 20px; font-weight: bold; }
        h1 { text-align: center; }
        @media (max-width: 768px) { .container { flex-direction: column; } }
    </style>
</head>
<body>
    <h1>GREEN-API Тестовый клиент</h1>
    
    <div class="container">
        <div class="left">
            <label>IdInstance:</label>
            <input type="text" id="idInstance" placeholder="1101815378">
            
            <label>ApiTokenInstance:</label>
            <input type="text" id="apiTokenInstance" placeholder="a1b2c3d4e5f67890123456789abcdef0">
            
            <button onclick="callMethod('getSettings')">getSettings</button>
            <button onclick="callMethod('getStateInstance')">getStateInstance</button>

            <label>Chat ID (например, 79991234567):</label>
            <input type="text" id="chatId" placeholder="79991234567">
            
            <label>Message (для sendMessage):</label>
            <input type="text" id="message" placeholder="Hello from GREEN-API!">

            <button onclick="callMethod('sendMessage')">sendMessage</button>

            <label>URL File (для sendFileByUrl):</label>
            <input type="text" id="urlFile" placeholder="https://example.com/image.jpg">
            
            <label>File Name (для sendFileByUrl):</label>
            <input type="text" id="fileName" value="image.jpg">
            
            <button onclick="callMethod('sendFileByUrl')">sendFileByUrl</button>
        </div>
        
        <div class="right">
            <label>Ответ API:</label>
            <textarea id="result" readonly placeholder="Результат появится здесь..."></textarea>
        </div>
    </div>

    <script>
        const API_URL = 'https://console.green-api.com';
        
        async function callMethod(method) {
            const idInstance = document.getElementById('idInstance').value.trim();
            const apiTokenInstance = document.getElementById('apiTokenInstance').value.trim();
            
            if (!idInstance || !apiTokenInstance) {
                alert('Введите idInstance и apiTokenInstance!');
                return;
            }
            
            const url = `${API_URL}/waInstance${idInstance}/${method}/${apiTokenInstance}`;
            
            try {
                let response;
                if (method === 'getSettings' || method === 'getStateInstance') {
                    response = await fetch(url);
                } else {
                    let body = {};
                    if (method === 'sendMessage') {
                        const chatId = document.getElementById('chatId').value.trim();
                        const message = document.getElementById('message').value.trim();
                        if (!chatId || !message) {
                            alert('Введите chatId и message!');
                            return;
                        }
                        body = { chatId, message };
                    } else if (method === 'sendFileByUrl') {
                        const chatId = document.getElementById('chatId').value.trim();
                        const urlFile = document.getElementById('urlFile').value.trim();
                        const fileName = document.getElementById('fileName').value.trim();
                        if (!chatId || !urlFile || !fileName) {
                            alert('Введите chatId, urlFile и fileName!');
                            return;
                        }
                        body = { chatId, urlFile, fileName };
                    }
                    response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(body)
                    });
                }
                
                const data = await response.json();
                document.getElementById('result').value = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('result').value = `Ошибка: ${error.message}`;
            }
        }
    </script>
</body>
</html>
